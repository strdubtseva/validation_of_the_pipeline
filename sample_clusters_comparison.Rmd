---
title: "Part of validation in R"
author: "Maria Starodubtseva"
output: 
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(fig.align = "center")
```


```{r}
library(readr)
library(dplyr)
library(stringr)
library(tidyr)
library(dplyr)
library(lubridate)
library(tidytext)
```



#### Loading Lenta dataset and making a sample

**Original dataset:** 800 975 texts 

**Sample:** random sample 860 texts per each of 10 opics 'Экономика', 'Спорт', 'Культура', 'Наука и техника', 'Интернет и СМИ', 'Силовые структуры', 'Бизнес', 'Политика', 'Происшествия', 'Общество и Путешествия', years 2010-2019 -> *8600 texts*


```{r}
#Dataset
lenta <- read_csv("~/Desktop/ic2s2_internet_regulation-master 2/lenta-ru-news.csv")

# change date
lenta$year <- format(as.Date(lenta$date, format="%Y/%m/%d"),"%Y")

lenta %>% group_by(topic) %>% dplyr::summarise(n=n()) %>% arrange(desc(n))

#choosing topics
lenta$topic[lenta$tags == 'Политика'] <- 'Политика'
lenta$topic[lenta$tags == 'Происшествия'] <- 'Происшествия'

#taking last 10 years and 10 topics
lenta_filt <- lenta %>% filter(year>2009) %>% 
  filter(topic %in% c('Экономика', 'Спорт', 'Культура', 'Наука и техника', 'Интернет и СМИ', 'Силовые структуры', 'Бизнес', 'Политика', 'Происшествия', 'Путешествия')) 


#choose 860 articles from each topic
# (important for SVM to have balanced number of articles per topic)

library(plyr)
set.seed(12)
new_df <- ddply(lenta_filt,.(topic),function(x) x[sample(nrow(x),860),])

new_df %>% group_by(topic, year) %>% dplyr::summarise(n=n()) %>% arrange(desc(n))
new_df %>% group_by(topic) %>% dplyr::summarise(n=n()) %>% arrange(desc(n))

new_df <- new_df %>% select(-url, -title, -date, -tags)

# save dataset
#new_df %>% write_csv("lenta_data.csv")

head(new_df, 3)
```



#### Loading term-year frquencies and computing tf-idf

```{r}
library(igraph)
```

```{r}
set.seed(1)
setwd("~/Desktop/ic2s2_internet_regulation-master 2")
filenames <- list.files(path="~/Desktop/ic2s2_internet_regulation-master 2/terms",
    pattern="*csv")

full_data <- data.frame(
  cat=factor(),
                term=character(),
                 count=numeric(),
                 stringsAsFactors=FALSE) 
for (fl in filenames){  
  dt_gath = read_csv(paste('~/Desktop/ic2s2_internet_regulation-master 2/terms/', fl, sep=''), locale = locale(encoding = 'utf-8'))
  dt <- dt_gath %>% dplyr::select(cat, term, count)
  full_data = rbind(full_data, dt)
}

fulldata = full_data[!duplicated(full_data), ]

full_data_num = fulldata %>% group_by(cat) %>% dplyr::summarize(num_words = n_distinct(term))
sum(full_data_num$num_words)
fulldata <- fulldata %>% bind_tf_idf(term, cat, count)

only_terms = fulldata['term']
only_terms = only_terms[!duplicated(only_terms), ]


Encoding(fulldata[['term']]) <- "UTF-8"
quantile(fulldata$tf_idf)
tfidf = fulldata$tf_idf
tfidf_25 = tfidf[tfidf > 0.0005443291] #25%
mean(tfidf_25)
```




#### Creating bipartite networks and obtaining communities with Louvain


```{r}
dfs <- data.frame(membership=character(),
                 term=character(),
                 count=numeric(),
                 stringsAsFactors=FALSE) 
for (fl in filenames){  
  dt_gath = read_csv(paste('~/Desktop/ic2s2_internet_regulation-master 2/terms/', fl, sep=''))
  med_drug <- dt_gath %>% dplyr::select(id, cat, term, count)
  fulldata =  dplyr::select(fulldata, cat, term, tf_idf)
  fulldata = fulldata[!duplicated(fulldata), ]
  med_drug <- left_join(med_drug, fulldata, by=c('cat', 'term'))
  med_drug <- med_drug %>% dplyr::select(id, term, tf_idf) %>% filter(tf_idf > 0.0004082960) #50%
  med_drug <- as.data.frame(med_drug)
  pc <- graph_from_data_frame(med_drug, directed = F) 
  V(pc)$type <- FALSE
  V(pc)$type[V(pc)$name %in% med_drug[, 1]] <- TRUE
  one_mode_networks <- bipartite_projection(pc)
  sgdf.copy <- one_mode_networks$proj1
  set.seed(1)
  fastgreedy_main <- cluster_louvain(sgdf.copy)
  table_fastgreedy_main <- cbind(fastgreedy_main$membership, fastgreedy_main$names)
  table_fastgreedy_main = as.data.frame(table_fastgreedy_main)
  table_fastgreedy_main$V1 = as.character(table_fastgreedy_main$V1)
  table_fastgreedy_main$V2 = as.character(table_fastgreedy_main$V2)
  colnames(table_fastgreedy_main)[1] <- "membership"
  colnames(table_fastgreedy_main)[2] <- "term"
  table_fastgreedy_main$membership <- paste(table_fastgreedy_main$membership, '_', fl, sep='')
  head(table_fastgreedy_main, 1)
  dfs = rbind(dfs, table_fastgreedy_main)
}
dfs$cat <- as.numeric(gsub("(.*?_terms_)(\\d+)(\\.csv)", "\\2", dfs$membership))

fin_df = left_join(dfs, select(fulldata, cat, term, tf_idf), by=c('cat', 'term'))
fin_df$cluster =  gsub("(.*)(_terms_)(.*?)(.csv)", "\\1", fin_df$membership)
fin_df$cluster = paste(fin_df$cat, fin_df$cluster, sep="_")

words_by_cluster = fin_df %>% group_by(fin_df$memb) %>% count()
fin_df %>% head()

fin_df %>% group_by(cluster) %>% dplyr::summarize(n=n()) %>% arrange(n)

```


#### Automated names of clusters

```{r}
fin_sum = fin_df %>% group_by(cat) %>% dplyr::summarize(sum_tfinf = sum(tf_idf))
fin_df = left_join(fin_df, fin_sum, by='cat')
fin_df$norm_tfidf = fin_df$tf_idf/fin_df$sum_tfinf
max_term = fin_df %>% #filter(nchar(term) > 9) %>% 
  group_by(cluster) %>%
  slice(which.max(norm_tfidf)) %>% mutate(memb = paste(term, cluster, sep = "_")) %>% select(cluster, memb)
fin_df = left_join(fin_df, max_term, by='cluster')


fin_df$memb <- as.factor(fin_df$memb)
fin_df %>% group_by(memb) %>% dplyr::summarise(n=n()) %>% arrange(n)

#write.csv(fin_df, 'fin_df.csv')

```


#### Connecting similar communities by computing cosine distances of vectors of TFIDF metrics


```{r , include=FALSE}
library(jsonlite)
library(stringr)
library(tidyr)
library(dplyr)
library(widyr)
library(ggplot2)
library(data.table)
library(readr)
library(psych)
library(ggraph)
#library(stm)
library(tm)
library(igraph)
library(lubridate)
library(tidytext)
```

```{r}
fin_df <- read_csv("fin_df.csv")

fin_df %>% group_by(memb) %>% dplyr::summarise(n=n()) %>% arrange(n)
```


```{r}
library(reshape2)
w <- dcast(fin_df, memb~term, value.var='norm_tfidf')
w = w[!is.na(w$memb),]

samp2 <- w[,-1]
rownames(samp2) <- w[,1]
samp2[is.na(samp2)] <- 0

library(wordspace)
library(Matrix)
samp2 = as.matrix(samp2)
A <- as(samp2, "sparseMatrix")       # see also `vignette("Intro2Matrix")`
B <- Matrix(samp2, sparse = TRUE)  
samp2_dsm = dsm(A)
dm = dist.matrix(samp2_dsm, method="cosine", convert=FALSE)
dm[ row(dm) == col(dm) ] <- NA

dm_df = as.data.frame(dm)

dm_df = dm_df %>% 
  tibble::rownames_to_column('id') %>%  # creates an ID number
  gather(dept, cnt, colnames(dm_df)[1]:colnames(dm_df)[length(colnames(dm_df))]) %>% 
  group_by(id) %>% 
  slice(which.max(cnt))  #?????? ??????????????????

dm_df = dm_df[!duplicated(data.frame(t(apply(dm_df[1:2], 1, sort)), dm_df$cnt)),]
dm_df[is.na(dm_df)] <- 0
#dm_df = dm_df %>% filter(cnt < 90)

nodes = data.frame(dm_df$id)
nodes$node = c(0:(nrow(nodes)-1))
colnames(nodes)[1] = 'name'
links = as.data.frame(dm_df)
names(links) = c("source", "target", "value")

colnames(nodes)[1] = 'source'
links = left_join(links, nodes, by='source')
links = links %>% dplyr::select(-source)
colnames(links)[3] = 'source'

colnames(nodes)[1] = 'target'
links = left_join(links, nodes, by='target')
links = links %>% dplyr::select(-target)
colnames(links)[3] = 'target'

links = na.omit(links)
colnames(nodes)[1] = 'name'
links = links %>% arrange(source)

links = links[!duplicated(data.frame(t(apply(links[2:3], 1, sort)), links$value)),]
links = group_by(links, value) %>% slice(1)
links = links[!duplicated(links[,1]),]
links_values = links %>% dplyr::select(value)

#write.csv(links, "links.csv", row.names = F)
#write.csv(nodes, "nodes.csv", row.names = F)
```


```{r}
# network of topic-clusters
graph <- graph_from_data_frame(links[2:3], directed = F) 
plot(graph)
```


#### Terms in final clusters 


```{r}
#25, 10, 22
dt_25 <- fin_df %>% filter(memb=="космический аппарат_2014_2") 
dt_10 <- fin_df %>% filter(memb=="военный экспорт_2011_3") 
dt_22 <- fin_df %>% filter(memb=="класс_2010_2") 
dt_25_10_22 <- bind_rows(dt_25, dt_10, dt_22)
dt_25_10_22 %>% select(term, norm_tfidf) %>% arrange(-norm_tfidf) 


#29, 40, 34, 36
dt_29 <- fin_df %>% filter(memb=="личный данные_2013_1") 
dt_40 <- fin_df %>% filter(memb=="реестр_2012_1") 
dt_34 <- fin_df %>% filter(memb=="новый работа_2010_3") 
dt_36 <- fin_df %>% filter(memb=="пользователь мочь_2014_1") 
dt_29_40_34_36 <- bind_rows(dt_29, dt_40, dt_34, dt_36)
dt_29_40_34_36 %>% select(term, norm_tfidf) %>% arrange(-norm_tfidf) 


#8, 13
dt_8 <- fin_df %>% filter(memb=="бывший полковник_2018_3") 
dt_13 <- fin_df %>% filter(memb=="дональд трамп_2019_1") 
dt_8_13 <- bind_rows(dt_8, dt_13)
dt_8_13 %>% select(term, norm_tfidf) %>% arrange(-norm_tfidf) 


#19, 52, 49, 44
dt_19 <- fin_df %>% filter(memb=="исламский государство_2015_4") 
dt_52 <- fin_df %>% filter(memb=="эрдоган_2016_3") 
dt_49 <- fin_df %>% filter(memb=="турецкий поток_2015_1") 
dt_44 <- fin_df %>% filter(memb=="свободный торговля_2014_4") 
dt_19_52_49_44 <- bind_rows(dt_19, dt_52, dt_49, dt_44)
dt_19_52_49_44 %>% select(term, norm_tfidf) %>% arrange(-norm_tfidf) 


#50, 47, 38, 51, 41
dt_50 <- fin_df %>% filter(memb=="углерод_2011_1") 
dt_47 <- fin_df %>% filter(memb=="товарищеский матч_2010_4") 
dt_38 <- fin_df %>% filter(memb=="пхенчхан_2018_6") 
dt_51 <- fin_df %>% filter(memb=="эквивалент финал_2014_6") 
dt_41 <- fin_df %>% filter(memb=="рио_2016_5") 
dt_50_47_38_51_41 <- bind_rows(dt_50, dt_47, dt_38, dt_51, dt_41)
dt_50_47_38_51_41 %>% select(term, norm_tfidf) %>% arrange(-norm_tfidf) 


#6, 3, 42
dt_6 <- fin_df %>% filter(memb=="богатый человек_2015_7") 
dt_3 <- fin_df %>% filter(memb=="афк система_2017_4") 
dt_42 <- fin_df %>% filter(memb=="роснефть_2016_1") 
dt_6_3_42 <- bind_rows(dt_6, dt_3, dt_42)
dt_6_3_42 %>% select(term, norm_tfidf) %>% arrange(-norm_tfidf) 


#43, 26
dt_43 <- fin_df %>% filter(memb=="рыба_2014_3") 
dt_26 <- fin_df %>% filter(memb=="кузнецов_2019_6")
dt_43_26 <- bind_rows(dt_43, dt_26)
dt_43_26%>% select(term, norm_tfidf) %>% arrange(-norm_tfidf) 


#46, 24, 39
dt_46 <- fin_df %>% filter(memb=="стадион_2014_5") 
dt_24 <- fin_df %>% filter(memb=="корреспондент лента_2017_1") 
dt_39 <- fin_df %>% filter(memb=="ракетный двигатель_2018_2") 
dt_46_24_39 <- bind_rows(dt_46, dt_24, dt_39)
dt_46_24_39 %>% select(term, norm_tfidf) %>% arrange(-norm_tfidf) 


#37, 35, 45, 27
dt_37 <- fin_df %>% filter(memb=="причем_2013_7") 
dt_35 <- fin_df %>% filter(memb=="персональный компьютер_2010_1") 
dt_45 <- fin_df %>% filter(memb=="сланцевый газ_2012_3") 
dt_27 <- fin_df %>% filter(memb=="культурный наследие_2013_4")
dt_37_35_45_27 <- bind_rows(dt_37, dt_35, dt_45, dt_27)
dt_37_35_45_27 %>% select(term, norm_tfidf) %>% arrange(-norm_tfidf)


#1, 0
dt_1 <- fin_df %>% filter(memb=="авиа_2017_5") 
dt_0 <- fin_df %>% filter(memb=="аварийный посадка_2019_5")
dt_1_0 <- bind_rows(dt_1, dt_0)
dt_1_0  %>% select(term, norm_tfidf) %>% arrange(-norm_tfidf) 


#30, 14, 15
dt_30 <- fin_df %>% filter(memb=="матч тв_2017_6") 
dt_14 <- fin_df %>% filter(memb=="европейский бизнес_2015_3")
dt_15 <- fin_df %>% filter(memb=="запрет поставка_2014_8")
dt_30_14_15 <- bind_rows(dt_30, dt_14, dt_15)
dt_30_14_15  %>% select(term, norm_tfidf) %>% arrange(-norm_tfidf) 
```


#### Correspondence of human-labeled and pipeline-labeled topics

Бизнес:
  * Most Correlated Unigrams are: месторождение, автомобиль, процент, фас, газопровод, холдинг, продукция, автоваз, автопроизводитель, трансаэро, производство, кубометр, рынок, ретейлер, газ, компания, газпром, предприятие, миллиард, роснефть
  * Most Correlated Bigrams are: процент миллиард, автомобиль россия, система платон, экономический форум, миллиард доллар, поставка газ, турецкий поток, совместный предприятие, природный газ, российский газ, российский компания, европейский бизнес, автомобиль процент, миллиард кубометр, тысяча машина, продажа автомобиль, арбитражный суд, процент акция, тысяча автомобиль, миллиард рубль

```{r}
dt_25_10_22 %>% filter(term %in% c("месторождение", "автомобиль", "процент", "фас", "газопровод", "холдинг", "продукция", "автоваз", "автопроизводитель", "трансаэро", "производство", "кубометр", "рынок", "ретейлер", "газ", "компания", "газпром", "предприятие", "миллиард", "роснефть", "процент миллиард", "автомобиль россия", "система платон", "экономический форум", "миллиард доллар", "поставка газ", "турецкий поток", "совместный предприятие", "природный газ", "российский газ", "российский компания", "европейский бизнес", "автомобиль процент", "миллиард кубометр", "тысяча машина", "продажа автомобиль", "арбитражный суд", "процент акция", "тысяча автомобиль", "миллиард рубль"))

dt_29_40_34_36 %>% filter(term %in% c("месторождение", "автомобиль", "процент", "фас", "газопровод", "холдинг", "продукция", "автоваз", "автопроизводитель", "трансаэро", "производство", "кубометр", "рынок", "ретейлер", "газ", "компания", "газпром", "предприятие", "миллиард", "роснефть", "процент миллиард", "автомобиль россия", "система платон", "экономический форум", "миллиард доллар", "поставка газ", "турецкий поток", "совместный предприятие", "природный газ", "российский газ", "российский компания", "европейский бизнес", "автомобиль процент", "миллиард кубометр", "тысяча машина", "продажа автомобиль", "арбитражный суд", "процент акция", "тысяча автомобиль", "миллиард рубль"))

dt_19_52_49_44 %>% filter(term %in% c("месторождение", "автомобиль", "процент", "фас", "газопровод", "холдинг", "продукция", "автоваз", "автопроизводитель", "трансаэро", "производство", "кубометр", "рынок", "ретейлер", "газ", "компания", "газпром", "предприятие", "миллиард", "роснефть", "процент миллиард", "автомобиль россия", "система платон", "экономический форум", "миллиард доллар", "поставка газ", "турецкий поток", "совместный предприятие", "природный газ", "российский газ", "российский компания", "европейский бизнес", "автомобиль процент", "миллиард кубометр", "тысяча машина", "продажа автомобиль", "арбитражный суд", "процент акция", "тысяча автомобиль", "миллиард рубль"))

dt_6_3_42 %>% filter(term %in% c("месторождение", "автомобиль", "процент", "фас", "газопровод", "холдинг", "продукция", "автоваз", "автопроизводитель", "трансаэро", "производство", "кубометр", "рынок", "ретейлер", "газ", "компания", "газпром", "предприятие", "миллиард", "роснефть", "процент миллиард", "автомобиль россия", "система платон", "экономический форум", "миллиард доллар", "поставка газ", "турецкий поток", "совместный предприятие", "природный газ", "российский газ", "российский компания", "европейский бизнес", "автомобиль процент", "миллиард кубометр", "тысяча машина", "продажа автомобиль", "арбитражный суд", "процент акция", "тысяча автомобиль", "миллиард рубль"))

dt_43_26 %>% filter(term %in% c("месторождение", "автомобиль", "процент", "фас", "газопровод", "холдинг", "продукция", "автоваз", "автопроизводитель", "трансаэро", "производство", "кубометр", "рынок", "ретейлер", "газ", "компания", "газпром", "предприятие", "миллиард", "роснефть", "процент миллиард", "автомобиль россия", "система платон", "экономический форум", "миллиард доллар", "поставка газ", "турецкий поток", "совместный предприятие", "природный газ", "российский газ", "российский компания", "европейский бизнес", "автомобиль процент", "миллиард кубометр", "тысяча машина", "продажа автомобиль", "арбитражный суд", "процент акция", "тысяча автомобиль", "миллиард рубль"))


dt_46_24_39  %>% filter(term %in% c("месторождение", "автомобиль", "процент", "фас", "газопровод", "холдинг", "продукция", "автоваз", "автопроизводитель", "трансаэро", "производство", "кубометр", "рынок", "ретейлер", "газ", "компания", "газпром", "предприятие", "миллиард", "роснефть", "процент миллиард", "автомобиль россия", "система платон", "экономический форум", "миллиард доллар", "поставка газ", "турецкий поток", "совместный предприятие", "природный газ", "российский газ", "российский компания", "европейский бизнес", "автомобиль процент", "миллиард кубометр", "тысяча машина", "продажа автомобиль", "арбитражный суд", "процент акция", "тысяча автомобиль", "миллиард рубль"))

dt_1_0  %>% filter(term %in% c("месторождение", "автомобиль", "процент", "фас", "газопровод", "холдинг", "продукция", "автоваз", "автопроизводитель", "трансаэро", "производство", "кубометр", "рынок", "ретейлер", "газ", "компания", "газпром", "предприятие", "миллиард", "роснефть", "процент миллиард", "автомобиль россия", "система платон", "экономический форум", "миллиард доллар", "поставка газ", "турецкий поток", "совместный предприятие", "природный газ", "российский газ", "российский компания", "европейский бизнес", "автомобиль процент", "миллиард кубометр", "тысяча машина", "продажа автомобиль", "арбитражный суд", "процент акция", "тысяча автомобиль", "миллиард рубль"))

dt_30_14_15  %>% filter(term %in% c("месторождение", "автомобиль", "процент", "фас", "газопровод", "холдинг", "продукция", "автоваз", "автопроизводитель", "трансаэро", "производство", "кубометр", "рынок", "ретейлер", "газ", "компания", "газпром", "предприятие", "миллиард", "роснефть", "процент миллиард", "автомобиль россия", "система платон", "экономический форум", "миллиард доллар", "поставка газ", "турецкий поток", "совместный предприятие", "природный газ", "российский газ", "российский компания", "европейский бизнес", "автомобиль процент", "миллиард кубометр", "тысяча машина", "продажа автомобиль", "арбитражный суд", "процент акция", "тысяча автомобиль", "миллиард рубль"))
```


Интернет и СМИ:
  * Most Correlated Unigrams are: ресурс, фотография, контент, сервис, подписчик, социальный, хакер, вконтакте, роскомнадзор, страница, юзер, сеть, блогер, ролик, интернет, редактор, аккаунт, рекламный, реклама, пользователь
  * Most Correlated Bigrams are: реклама рекламный, авторский право, интернет ресурс, тысяча пользователь, сообщение пользователь, детский порнография, миллион пользователь, пиратский контент, живой журнал, пользователь мочь, интернет компания, тысяча лайков, би би, рекламный ролик, реестр сайт, пользователь сеть, издательский дом, рекламный кампания, главный редактор, социальный сеть


```{r}
dt_1_0 %>% filter(term %in% c("ресурс", "фотография", "контент", "сервис", "подписчик", "социальный", "хакер", "вконтакте", "роскомнадзор", "страница", "юзер", "сеть", "блогер", "ролик", "интернет", "редактор", "аккаунт", "рекламный", "реклама", "пользователь", "реклама рекламный", "авторский право", "интернет ресурс", "тысяча пользователь", "сообщение пользователь", "детский порнография", "миллион пользователь", "пиратский контент", "живой журнал", "пользователь мочь", "интернет компания", "тысяча лайков", "би би", "рекламный ролик", "реестр сайт", "пользователь сеть", "издательский дом", "рекламный кампания", "главный редактор", "социальный сеть"))

dt_29_40_34_36 %>% filter(term %in% c("ресурс", "фотография", "контент", "сервис", "подписчик", "социальный", "хакер", "вконтакте", "роскомнадзор", "страница", "юзер", "сеть", "блогер", "ролик", "интернет", "редактор", "аккаунт", "рекламный", "реклама", "пользователь", "реклама рекламный", "авторский право", "интернет ресурс", "тысяча пользователь", "сообщение пользователь", "детский порнография", "миллион пользователь", "пиратский контент", "живой журнал", "пользователь мочь", "интернет компания", "тысяча лайков", "би би", "рекламный ролик", "реестр сайт", "пользователь сеть", "издательский дом", "рекламный кампания", "главный редактор", "социальный сеть"))

dt_30_14_15 %>% filter(term %in% c("ресурс", "фотография", "контент", "сервис", "подписчик", "социальный", "хакер", "вконтакте", "роскомнадзор", "страница", "юзер", "сеть", "блогер", "ролик", "интернет", "редактор", "аккаунт", "рекламный", "реклама", "пользователь", "реклама рекламный", "авторский право", "интернет ресурс", "тысяча пользователь", "сообщение пользователь", "детский порнография", "миллион пользователь", "пиратский контент", "живой журнал", "пользователь мочь", "интернет компания", "тысяча лайков", "би би", "рекламный ролик", "реестр сайт", "пользователь сеть", "издательский дом", "рекламный кампания", "главный редактор", "социальный сеть"))

dt_37_35_45_27 %>% filter(term %in% c("ресурс", "фотография", "контент", "сервис", "подписчик", "социальный", "хакер", "вконтакте", "роскомнадзор", "страница", "юзер", "сеть", "блогер", "ролик", "интернет", "редактор", "аккаунт", "рекламный", "реклама", "пользователь", "реклама рекламный", "авторский право", "интернет ресурс", "тысяча пользователь", "сообщение пользователь", "детский порнография", "миллион пользователь", "пиратский контент", "живой журнал", "пользователь мочь", "интернет компания", "тысяча лайков", "би би", "рекламный ролик", "реестр сайт", "пользователь сеть", "издательский дом", "рекламный кампания", "главный редактор", "социальный сеть"))

dt_50_47_38_51_41 %>% filter(term %in% c("ресурс", "фотография", "контент", "сервис", "подписчик", "социальный", "хакер", "вконтакте", "роскомнадзор", "страница", "юзер", "сеть", "блогер", "ролик", "интернет", "редактор", "аккаунт", "рекламный", "реклама", "пользователь", "реклама рекламный", "авторский право", "интернет ресурс", "тысяча пользователь", "сообщение пользователь", "детский порнография", "миллион пользователь", "пиратский контент", "живой журнал", "пользователь мочь", "интернет компания", "тысяча лайков", "би би", "рекламный ролик", "реестр сайт", "пользователь сеть", "издательский дом", "рекламный кампания", "главный редактор", "социальный сеть"))
```


Культура:
  * Most Correlated Unigrams are: писатель, певица, музей, актриса, произведение, артист, коллектив, концерт, художник, пластинка, театр, прокат, песня, роль, музыкант, актер, режиссер, альбом, картина, фильм
  * Most Correlated Bigrams are: актерский состав, литературный премия, новый песня, роль фильм, хороший фильм, фильм картина, режиссер картина, американский киноакадемия, новый картина, главный герой, современный искусство, прокат миллион, министр культура, съемка фильм, министерство культура, народный артист, новый альбом, новый фильм, студийный альбом, главный роль


```{r}
dt_29_40_34_36 %>% filter(term %in% c("писатель", "певица", "музей", "актриса", "произведение", "артист", "коллектив", "концерт", "художник", "пластинка", "театр", "прокат", "песня", "роль", "музыкант", "актер", "режиссер", "альбом", "картина", "фильм", "актерский состав", "литературный премия", "новый песня", "роль фильм", "хороший фильм", "фильм картина", "режиссер картина", "американский киноакадемия", "новый картина", "главный герой", "современный искусство", "прокат миллион", "министр культура", "съемка фильм", "министерство культура", "народный артист", "новый альбом", "новый фильм", "студийный альбом", "главный роль"))

dt_37_35_45_27 %>% filter(term %in% c("писатель", "певица", "музей", "актриса", "произведение", "артист", "коллектив", "концерт", "художник", "пластинка", "театр", "прокат", "песня", "роль", "музыкант", "актер", "режиссер", "альбом", "картина", "фильм", "актерский состав", "литературный премия", "новый песня", "роль фильм", "хороший фильм", "фильм картина", "режиссер картина", "американский киноакадемия", "новый картина", "главный герой", "современный искусство", "прокат миллион", "министр культура", "съемка фильм", "министерство культура", "народный артист", "новый альбом", "новый фильм", "студийный альбом", "главный роль"))

dt_43_26 %>% filter(term %in% c("писатель", "певица", "музей", "актриса", "произведение", "артист", "коллектив", "концерт", "художник", "пластинка", "театр", "прокат", "песня", "роль", "музыкант", "актер", "режиссер", "альбом", "картина", "фильм", "актерский состав", "литературный премия", "новый песня", "роль фильм", "хороший фильм", "фильм картина", "режиссер картина", "американский киноакадемия", "новый картина", "главный герой", "современный искусство", "прокат миллион", "министр культура", "съемка фильм", "министерство культура", "народный артист", "новый альбом", "новый фильм", "студийный альбом", "главный роль"))

```


Наука и техника:
  * Most Correlated Unigrams are: процессор, носитель, ген, астроном, поверхность, игра, ученый, мкс, шутер, планета, исследование, спутник, разработчик, космический, устройство, орбита, смартфон, исследователь, аппарат, консоль
  * Most Correlated Bigrams are: новый смартфон, версия игра, карликовый планета, задний панель, дюймовый экран, официальный блог, новый исследование, новый игра, релиз игра, космический агентство, новый часть, небесный тело, черный дыра, игра продажа, ракета носитель, исследование журнал, космический корабль, персональный компьютер, космический станция, операционный система
  

```{r}
dt_25_10_22 %>% filter(term %in% c("процессор", "носитель", "ген", "астроном", "поверхность", "игра", "ученый", "мкс", "шутер", "планета", "исследование", "спутник", "разработчик", "космический", "устройство", "орбита", "смартфон", "исследователь", "аппарат", "консоль", "новый смартфон", "версия игра", "карликовый планета", "задний панель", "дюймовый экран", "официальный блог", "новый исследование", "новый игра", "релиз игра", "космический агентство", "новый часть", "небесный тело", "черный дыра", "игра продажа", "ракета носитель", "исследование журнал", "космический корабль", "персональный компьютер", "космический станция", "операционный система"))

dt_29_40_34_36 %>% filter(term %in% c("процессор", "носитель", "ген", "астроном", "поверхность", "игра", "ученый", "мкс", "шутер", "планета", "исследование", "спутник", "разработчик", "космический", "устройство", "орбита", "смартфон", "исследователь", "аппарат", "консоль", "новый смартфон", "версия игра", "карликовый планета", "задний панель", "дюймовый экран", "официальный блог", "новый исследование", "новый игра", "релиз игра", "космический агентство", "новый часть", "небесный тело", "черный дыра", "игра продажа", "ракета носитель", "исследование журнал", "космический корабль", "персональный компьютер", "космический станция", "операционный система"))

dt_30_14_15 %>% filter(term %in% c("процессор", "носитель", "ген", "астроном", "поверхность", "игра", "ученый", "мкс", "шутер", "планета", "исследование", "спутник", "разработчик", "космический", "устройство", "орбита", "смартфон", "исследователь", "аппарат", "консоль", "новый смартфон", "версия игра", "карликовый планета", "задний панель", "дюймовый экран", "официальный блог", "новый исследование", "новый игра", "релиз игра", "космический агентство", "новый часть", "небесный тело", "черный дыра", "игра продажа", "ракета носитель", "исследование журнал", "космический корабль", "персональный компьютер", "космический станция", "операционный система"))

dt_37_35_45_27 %>% filter(term %in% c("процессор", "носитель", "ген", "астроном", "поверхность", "игра", "ученый", "мкс", "шутер", "планета", "исследование", "спутник", "разработчик", "космический", "устройство", "орбита", "смартфон", "исследователь", "аппарат", "консоль", "новый смартфон", "версия игра", "карликовый планета", "задний панель", "дюймовый экран", "официальный блог", "новый исследование", "новый игра", "релиз игра", "космический агентство", "новый часть", "небесный тело", "черный дыра", "игра продажа", "ракета носитель", "исследование журнал", "космический корабль", "персональный компьютер", "космический станция", "операционный система"))

dt_43_26 %>% filter(term %in% c("процессор", "носитель", "ген", "астроном", "поверхность", "игра", "ученый", "мкс", "шутер", "планета", "исследование", "спутник", "разработчик", "космический", "устройство", "орбита", "смартфон", "исследователь", "аппарат", "консоль", "новый смартфон", "версия игра", "карликовый планета", "задний панель", "дюймовый экран", "официальный блог", "новый исследование", "новый игра", "релиз игра", "космический агентство", "новый часть", "небесный тело", "черный дыра", "игра продажа", "ракета носитель", "исследование журнал", "космический корабль", "персональный компьютер", "космический станция", "операционный система"))

dt_46_24_39 %>% filter(term %in% c("процессор", "носитель", "ген", "астроном", "поверхность", "игра", "ученый", "мкс", "шутер", "планета", "исследование", "спутник", "разработчик", "космический", "устройство", "орбита", "смартфон", "исследователь", "аппарат", "консоль", "новый смартфон", "версия игра", "карликовый планета", "задний панель", "дюймовый экран", "официальный блог", "новый исследование", "новый игра", "релиз игра", "космический агентство", "новый часть", "небесный тело", "черный дыра", "игра продажа", "ракета носитель", "исследование журнал", "космический корабль", "персональный компьютер", "космический станция", "операционный система"))

dt_50_47_38_51_41 %>% filter(term %in% c("процессор", "носитель", "ген", "астроном", "поверхность", "игра", "ученый", "мкс", "шутер", "планета", "исследование", "спутник", "разработчик", "космический", "устройство", "орбита", "смартфон", "исследователь", "аппарат", "консоль", "новый смартфон", "версия игра", "карликовый планета", "задний панель", "дюймовый экран", "официальный блог", "новый исследование", "новый игра", "релиз игра", "космический агентство", "новый часть", "небесный тело", "черный дыра", "игра продажа", "ракета носитель", "исследование журнал", "космический корабль", "персональный компьютер", "космический станция", "операционный система"))
```


Политика:
  * Most Correlated Unigrams are: политик, сирия, избирательный, парламент, сша, депутат, кремль, демократический, спикер, дипломат, партия, вашингтон, лидер, песок, мид, дональд, путин, президент, трамп, выборы
  * Most Correlated Bigrams are: скрипаль дочь, сергей скрипаль, президентский выборы, секретарь президент, мид россия, российский президент, россия владимир, демократический партия, иностранный дело, американский лидер, дмитрий песок, глава государство, глава мид, белый дом, российский лидер, президент россия, владимир путин, сша дональд, дональд трамп, президент сша


```{r}
dt_19_52_49_44 %>% filter(term %in% c("политик", "сирия", "избирательный", "парламент", "сша", "депутат", "кремль", "демократический", "спикер", "дипломат", "партия", "вашингтон", "лидер", "песок", "мид", "дональд", "путин", "президент", "трамп", "выборы", "скрипаль дочь", "сергей скрипаль", "президентский выборы", "секретарь президент", "мид россия", "российский президент", "россия владимир", "демократический партия", "иностранный дело", "американский лидер", "дмитрий песок", "глава государство", "глава мид", "белый дом", "российский лидер", "президент россия", "владимир путин", "сша дональд", "дональд трамп", "президент сша"))

dt_29_40_34_36 %>% filter(term %in% c("политик", "сирия", "избирательный", "парламент", "сша", "депутат", "кремль", "демократический", "спикер", "дипломат", "партия", "вашингтон", "лидер", "песок", "мид", "дональд", "путин", "президент", "трамп", "выборы", "скрипаль дочь", "сергей скрипаль", "президентский выборы", "секретарь президент", "мид россия", "российский президент", "россия владимир", "демократический партия", "иностранный дело", "американский лидер", "дмитрий песок", "глава государство", "глава мид", "белый дом", "российский лидер", "президент россия", "владимир путин", "сша дональд", "дональд трамп", "президент сша"))

dt_37_35_45_27 %>% filter(term %in% c("политик", "сирия", "избирательный", "парламент", "сша", "депутат", "кремль", "демократический", "спикер", "дипломат", "партия", "вашингтон", "лидер", "песок", "мид", "дональд", "путин", "президент", "трамп", "выборы", "скрипаль дочь", "сергей скрипаль", "президентский выборы", "секретарь президент", "мид россия", "российский президент", "россия владимир", "демократический партия", "иностранный дело", "американский лидер", "дмитрий песок", "глава государство", "глава мид", "белый дом", "российский лидер", "президент россия", "владимир путин", "сша дональд", "дональд трамп", "президент сша"))

dt_43_26 %>% filter(term %in% c("политик", "сирия", "избирательный", "парламент", "сша", "депутат", "кремль", "демократический", "спикер", "дипломат", "партия", "вашингтон", "лидер", "песок", "мид", "дональд", "путин", "президент", "трамп", "выборы", "скрипаль дочь", "сергей скрипаль", "президентский выборы", "секретарь президент", "мид россия", "российский президент", "россия владимир", "демократический партия", "иностранный дело", "американский лидер", "дмитрий песок", "глава государство", "глава мид", "белый дом", "российский лидер", "президент россия", "владимир путин", "сша дональд", "дональд трамп", "президент сша"))

dt_8_13 %>% filter(term %in% c("политик", "сирия", "избирательный", "парламент", "сша", "депутат", "кремль", "демократический", "спикер", "дипломат", "партия", "вашингтон", "лидер", "песок", "мид", "дональд", "путин", "президент", "трамп", "выборы", "скрипаль дочь", "сергей скрипаль", "президентский выборы", "секретарь президент", "мид россия", "российский президент", "россия владимир", "демократический партия", "иностранный дело", "американский лидер", "дмитрий песок", "глава государство", "глава мид", "белый дом", "российский лидер", "президент россия", "владимир путин", "сша дональд", "дональд трамп", "президент сша"))
```



Происшествия:
  * Most Correlated Unigrams are: местный, женщина, рельс, пожарный, экстренный, человек, авария, водитель, взрыв, дтп, очевидец, мужчина, больница, спасатель, возгорание, полиция, мчс, инцидент, происшествие, пожар
  * Most Correlated Bigrams are: человек человек, человек инцидент, результат инцидент, американский штат, медицинский помощь, спасательный операция, летний мужчина, издание инцидент, член экипаж, причина взрыв, правоохранительный орган, пассажир член, американский город, жилой дом, скорый помощь, местный время, аварийный посадка, предварительный данные, экстренный служба, место происшествие
  
  
```{r}
dt_1_0 %>% filter(term %in% c("местный", "женщина", "рельс", "пожарный", "экстренный", "человек", "авария", "водитель", "взрыв", "дтп", "очевидец", "мужчина", "больница", "спасатель", "возгорание", "полиция", "мчс", "инцидент", "происшествие", "пожар", "человек человек", "человек инцидент", "результат инцидент", "американский штат", "медицинский помощь", "спасательный операция", "летний мужчина", "издание инцидент", "член экипаж", "причина взрыв", "правоохранительный орган", "пассажир член", "американский город", "жилой дом", "скорый помощь", "местный время", "аварийный посадка", "предварительный данные", "экстренный служба", "место происшествие"))

dt_43_26 %>% filter(term %in% c("местный", "женщина", "рельс", "пожарный", "экстренный", "человек", "авария", "водитель", "взрыв", "дтп", "очевидец", "мужчина", "больница", "спасатель", "возгорание", "полиция", "мчс", "инцидент", "происшествие", "пожар", "человек человек", "человек инцидент", "результат инцидент", "американский штат", "медицинский помощь", "спасательный операция", "летний мужчина", "издание инцидент", "член экипаж", "причина взрыв", "правоохранительный орган", "пассажир член", "американский город", "жилой дом", "скорый помощь", "местный время", "аварийный посадка", "предварительный данные", "экстренный служба", "место происшествие"))

dt_46_24_39 %>% filter(term %in% c("местный", "женщина", "рельс", "пожарный", "экстренный", "человек", "авария", "водитель", "взрыв", "дтп", "очевидец", "мужчина", "больница", "спасатель", "возгорание", "полиция", "мчс", "инцидент", "происшествие", "пожар", "человек человек", "человек инцидент", "результат инцидент", "американский штат", "медицинский помощь", "спасательный операция", "летний мужчина", "издание инцидент", "член экипаж", "причина взрыв", "правоохранительный орган", "пассажир член", "американский город", "жилой дом", "скорый помощь", "местный время", "аварийный посадка", "предварительный данные", "экстренный служба", "место происшествие"))

dt_6_3_42 %>% filter(term %in% c("местный", "женщина", "рельс", "пожарный", "экстренный", "человек", "авария", "водитель", "взрыв", "дтп", "очевидец", "мужчина", "больница", "спасатель", "возгорание", "полиция", "мчс", "инцидент", "происшествие", "пожар", "человек человек", "человек инцидент", "результат инцидент", "американский штат", "медицинский помощь", "спасательный операция", "летний мужчина", "издание инцидент", "член экипаж", "причина взрыв", "правоохранительный орган", "пассажир член", "американский город", "жилой дом", "скорый помощь", "местный время", "аварийный посадка", "предварительный данные", "экстренный служба", "место происшествие"))

```


Путешествия:
  * Most Correlated Unigrams are: ростуризм, бронирование, авиабилет, билет, направление, авиакомпания, гостиница, поездка, аэропорт, туризм, перелет, туроператор, курорт, туристический, путешествие, рейс, отдых, отель, путешественник, турист
  * Most Correlated Bigrams are: пятизвездочный отель, визовый центр, рубль сутки, майский праздник, новогодний праздник, чартерный рейс, северный столица, шарм эль, международный аэропорт, туту ру, популярный направление, порядок убывание, тысяча рубль, россия атор, воздушный гавань, туроператор россия, туристический сервис, ассоциация туроператор, российский путешественник, российский турист


```{r}
dt_1_0 %>% filter(term %in% c("ростуризм", "бронирование", "авиабилет", "билет", "направление", "авиакомпания", "гостиница", "поездка", "аэропорт", "туризм", "перелет", "туроператор", "курорт", "туристический", "путешествие", "рейс", "отдых", "отель", "путешественник", "турист", "пятизвездочный отель", "визовый центр", "рубль сутки", "майский праздник", "новогодний праздник", "чартерный рейс", "северный столица", "шарм эль", "международный аэропорт", "туту ру", "популярный направление", "порядок убывание", "тысяча рубль", "россия атор", "воздушный гавань", "туроператор россия", "туристический сервис", "ассоциация туроператор", "российский путешественник", "российский турист"))

dt_19_52_49_44 %>% filter(term %in% c("ростуризм", "бронирование", "авиабилет", "билет", "направление", "авиакомпания", "гостиница", "поездка", "аэропорт", "туризм", "перелет", "туроператор", "курорт", "туристический", "путешествие", "рейс", "отдых", "отель", "путешественник", "турист", "пятизвездочный отель", "визовый центр", "рубль сутки", "майский праздник", "новогодний праздник", "чартерный рейс", "северный столица", "шарм эль", "международный аэропорт", "туту ру", "популярный направление", "порядок убывание", "тысяча рубль", "россия атор", "воздушный гавань", "туроператор россия", "туристический сервис", "ассоциация туроператор", "российский путешественник", "российский турист"))

dt_29_40_34_36 %>% filter(term %in% c("ростуризм", "бронирование", "авиабилет", "билет", "направление", "авиакомпания", "гостиница", "поездка", "аэропорт", "туризм", "перелет", "туроператор", "курорт", "туристический", "путешествие", "рейс", "отдых", "отель", "путешественник", "турист", "пятизвездочный отель", "визовый центр", "рубль сутки", "майский праздник", "новогодний праздник", "чартерный рейс", "северный столица", "шарм эль", "международный аэропорт", "туту ру", "популярный направление", "порядок убывание", "тысяча рубль", "россия атор", "воздушный гавань", "туроператор россия", "туристический сервис", "ассоциация туроператор", "российский путешественник", "российский турист"))

dt_30_14_15 %>% filter(term %in% c("ростуризм", "бронирование", "авиабилет", "билет", "направление", "авиакомпания", "гостиница", "поездка", "аэропорт", "туризм", "перелет", "туроператор", "курорт", "туристический", "путешествие", "рейс", "отдых", "отель", "путешественник", "турист", "пятизвездочный отель", "визовый центр", "рубль сутки", "майский праздник", "новогодний праздник", "чартерный рейс", "северный столица", "шарм эль", "международный аэропорт", "туту ру", "популярный направление", "порядок убывание", "тысяча рубль", "россия атор", "воздушный гавань", "туроператор россия", "туристический сервис", "ассоциация туроператор", "российский путешественник", "российский турист"))


dt_46_24_39 %>% filter(term %in% c("ростуризм", "бронирование", "авиабилет", "билет", "направление", "авиакомпания", "гостиница", "поездка", "аэропорт", "туризм", "перелет", "туроператор", "курорт", "туристический", "путешествие", "рейс", "отдых", "отель", "путешественник", "турист", "пятизвездочный отель", "визовый центр", "рубль сутки", "майский праздник", "новогодний праздник", "чартерный рейс", "северный столица", "шарм эль", "международный аэропорт", "туту ру", "популярный направление", "порядок убывание", "тысяча рубль", "россия атор", "воздушный гавань", "туроператор россия", "туристический сервис", "ассоциация туроператор", "российский путешественник", "российский турист"))

dt_50_47_38_51_41 %>% filter(term %in% c("ростуризм", "бронирование", "авиабилет", "билет", "направление", "авиакомпания", "гостиница", "поездка", "аэропорт", "туризм", "перелет", "туроператор", "курорт", "туристический", "путешествие", "рейс", "отдых", "отель", "путешественник", "турист", "пятизвездочный отель", "визовый центр", "рубль сутки", "майский праздник", "новогодний праздник", "чартерный рейс", "северный столица", "шарм эль", "международный аэропорт", "туту ру", "популярный направление", "порядок убывание", "тысяча рубль", "россия атор", "воздушный гавань", "туроператор россия", "туристический сервис", "ассоциация туроператор", "российский путешественник", "российский турист"))

dt_8_13 %>% filter(term %in% c("ростуризм", "бронирование", "авиабилет", "билет", "направление", "авиакомпания", "гостиница", "поездка", "аэропорт", "туризм", "перелет", "туроператор", "курорт", "туристический", "путешествие", "рейс", "отдых", "отель", "путешественник", "турист", "пятизвездочный отель", "визовый центр", "рубль сутки", "майский праздник", "новогодний праздник", "чартерный рейс", "северный столица", "шарм эль", "международный аэропорт", "туту ру", "популярный направление", "порядок убывание", "тысяча рубль", "россия атор", "воздушный гавань", "туроператор россия", "туристический сервис", "ассоциация туроператор", "российский путешественник", "российский турист"))
```


Силовые структуры:
  * Most Correlated Unigrams are: управление, тип, оружие, вооружение, фсб, следователь, статья, преступление, дело, розыск, убийство, минобороны, военный, мвд, колония, скр, следственный, ук, уголовный, следствие
  * Most Correlated Bigrams are: криминальный авторитет, строгий режим, сотрудник фсб, незаконный оборот, уголовный розыск, правоохранительный орган, вооруженный сила, данные следствие, общий режим, военный округ, мера пресечение, министерство оборона, лишение свобода, военный ведомство, ук рф, версия следствие, часть статья, следственный комитет, статья ук, уголовный дело



```{r}
dt_1_0 %>% filter(term %in% c("управление", "тип", "оружие", "вооружение", "фсб", "следователь", "статья", "преступление", "дело", "розыск", "убийство", "минобороны", "военный", "мвд", "колония", "скр", "следственный", "ук", "уголовный", "следствие", "криминальный авторитет", "строгий режим", "сотрудник фсб", "незаконный оборот", "уголовный розыск", "правоохранительный орган", "вооруженный сила", "данные следствие", "общий режим", "военный округ", "мера пресечение", "министерство оборона", "лишение свобода", "военный ведомство", "ук рф", "версия следствие", "часть статья", "следственный комитет", "статья ук", "уголовный дело"))

dt_19_52_49_44 %>% filter(term %in% c("управление", "тип", "оружие", "вооружение", "фсб", "следователь", "статья", "преступление", "дело", "розыск", "убийство", "минобороны", "военный", "мвд", "колония", "скр", "следственный", "ук", "уголовный", "следствие", "криминальный авторитет", "строгий режим", "сотрудник фсб", "незаконный оборот", "уголовный розыск", "правоохранительный орган", "вооруженный сила", "данные следствие", "общий режим", "военный округ", "мера пресечение", "министерство оборона", "лишение свобода", "военный ведомство", "ук рф", "версия следствие", "часть статья", "следственный комитет", "статья ук", "уголовный дело"))

dt_25_10_22 %>% filter(term %in% c("управление", "тип", "оружие", "вооружение", "фсб", "следователь", "статья", "преступление", "дело", "розыск", "убийство", "минобороны", "военный", "мвд", "колония", "скр", "следственный", "ук", "уголовный", "следствие", "криминальный авторитет", "строгий режим", "сотрудник фсб", "незаконный оборот", "уголовный розыск", "правоохранительный орган", "вооруженный сила", "данные следствие", "общий режим", "военный округ", "мера пресечение", "министерство оборона", "лишение свобода", "военный ведомство", "ук рф", "версия следствие", "часть статья", "следственный комитет", "статья ук", "уголовный дело"))

dt_43_26 %>% filter(term %in% c("управление", "тип", "оружие", "вооружение", "фсб", "следователь", "статья", "преступление", "дело", "розыск", "убийство", "минобороны", "военный", "мвд", "колония", "скр", "следственный", "ук", "уголовный", "следствие", "криминальный авторитет", "строгий режим", "сотрудник фсб", "незаконный оборот", "уголовный розыск", "правоохранительный орган", "вооруженный сила", "данные следствие", "общий режим", "военный округ", "мера пресечение", "министерство оборона", "лишение свобода", "военный ведомство", "ук рф", "версия следствие", "часть статья", "следственный комитет", "статья ук", "уголовный дело"))

dt_46_24_39 %>% filter(term %in% c("управление", "тип", "оружие", "вооружение", "фсб", "следователь", "статья", "преступление", "дело", "розыск", "убийство", "минобороны", "военный", "мвд", "колония", "скр", "следственный", "ук", "уголовный", "следствие", "криминальный авторитет", "строгий режим", "сотрудник фсб", "незаконный оборот", "уголовный розыск", "правоохранительный орган", "вооруженный сила", "данные следствие", "общий режим", "военный округ", "мера пресечение", "министерство оборона", "лишение свобода", "военный ведомство", "ук рф", "версия следствие", "часть статья", "следственный комитет", "статья ук", "уголовный дело"))

dt_50_47_38_51_41 %>% filter(term %in% c("управление", "тип", "оружие", "вооружение", "фсб", "следователь", "статья", "преступление", "дело", "розыск", "убийство", "минобороны", "военный", "мвд", "колония", "скр", "следственный", "ук", "уголовный", "следствие", "криминальный авторитет", "строгий режим", "сотрудник фсб", "незаконный оборот", "уголовный розыск", "правоохранительный орган", "вооруженный сила", "данные следствие", "общий режим", "военный округ", "мера пресечение", "министерство оборона", "лишение свобода", "военный ведомство", "ук рф", "версия следствие", "часть статья", "следственный комитет", "статья ук", "уголовный дело"))

dt_6_3_42 %>% filter(term %in% c("управление", "тип", "оружие", "вооружение", "фсб", "следователь", "статья", "преступление", "дело", "розыск", "убийство", "минобороны", "военный", "мвд", "колония", "скр", "следственный", "ук", "уголовный", "следствие", "криминальный авторитет", "строгий режим", "сотрудник фсб", "незаконный оборот", "уголовный розыск", "правоохранительный орган", "вооруженный сила", "данные следствие", "общий режим", "военный округ", "мера пресечение", "министерство оборона", "лишение свобода", "военный ведомство", "ук рф", "версия следствие", "часть статья", "следственный комитет", "статья ук", "уголовный дело"))

dt_8_13 %>% filter(term %in% c("управление", "тип", "оружие", "вооружение", "фсб", "следователь", "статья", "преступление", "дело", "розыск", "убийство", "минобороны", "военный", "мвд", "колония", "скр", "следственный", "ук", "уголовный", "следствие", "криминальный авторитет", "строгий режим", "сотрудник фсб", "незаконный оборот", "уголовный розыск", "правоохранительный орган", "вооруженный сила", "данные следствие", "общий режим", "военный округ", "мера пресечение", "министерство оборона", "лишение свобода", "военный ведомство", "ук рф", "версия следствие", "часть статья", "следственный комитет", "статья ук", "уголовный дело"))
```


Спорт:
  * Most Correlated Unigrams are: сезон, игрок, форвард, мяч, победа, футбольный, спорт, финал, спортсмен, кубок, футболист, турнир, тренер, чемпион, лига, клуб, команда, сборная, чемпионат, матч
  * Most Correlated Bigrams are: чемпионат европа, матч тур, тур чемпионат, матч чемпионат, финал лига, регулярный чемпионат, хоккейный лига, турнирный таблица, национальный команда, олимпийский игра, групповой этап, чемпион мир, футбольный клуб, официальный сайт, плей офф, чемпионат россия, лига чемпион, сборная россия, чемпионат мир, главный тренер


```{r}
dt_29_40_34_36 %>% filter(term %in% c("сезон", "игрок", "форвард", "мяч", "победа", "футбольный", "спорт", "финал", "спортсмен", "кубок", "футболист", "турнир", "тренер", "чемпион", "лига", "клуб", "команда", "сборная", "чемпионат", "матч", "чемпионат европа", "матч тур", "тур чемпионат", "матч чемпионат", "финал лига", "регулярный чемпионат", "хоккейный лига", "турнирный таблица", "национальный команда", "олимпийский игра", "групповой этап", "чемпион мир", "футбольный клуб", "официальный сайт", "плей офф", "чемпионат россия", "лига чемпион", "сборная россия", "чемпионат мир", "главный тренер"))

dt_30_14_15 %>% filter(term %in% c("сезон", "игрок", "форвард", "мяч", "победа", "футбольный", "спорт", "финал", "спортсмен", "кубок", "футболист", "турнир", "тренер", "чемпион", "лига", "клуб", "команда", "сборная", "чемпионат", "матч", "чемпионат европа", "матч тур", "тур чемпионат", "матч чемпионат", "финал лига", "регулярный чемпионат", "хоккейный лига", "турнирный таблица", "национальный команда", "олимпийский игра", "групповой этап", "чемпион мир", "футбольный клуб", "официальный сайт", "плей офф", "чемпионат россия", "лига чемпион", "сборная россия", "чемпионат мир", "главный тренер"))

dt_37_35_45_27 %>% filter(term %in% c("сезон", "игрок", "форвард", "мяч", "победа", "футбольный", "спорт", "финал", "спортсмен", "кубок", "футболист", "турнир", "тренер", "чемпион", "лига", "клуб", "команда", "сборная", "чемпионат", "матч", "чемпионат европа", "матч тур", "тур чемпионат", "матч чемпионат", "финал лига", "регулярный чемпионат", "хоккейный лига", "турнирный таблица", "национальный команда", "олимпийский игра", "групповой этап", "чемпион мир", "футбольный клуб", "официальный сайт", "плей офф", "чемпионат россия", "лига чемпион", "сборная россия", "чемпионат мир", "главный тренер"))

dt_43_26 %>% filter(term %in% c("сезон", "игрок", "форвард", "мяч", "победа", "футбольный", "спорт", "финал", "спортсмен", "кубок", "футболист", "турнир", "тренер", "чемпион", "лига", "клуб", "команда", "сборная", "чемпионат", "матч", "чемпионат европа", "матч тур", "тур чемпионат", "матч чемпионат", "финал лига", "регулярный чемпионат", "хоккейный лига", "турнирный таблица", "национальный команда", "олимпийский игра", "групповой этап", "чемпион мир", "футбольный клуб", "официальный сайт", "плей офф", "чемпионат россия", "лига чемпион", "сборная россия", "чемпионат мир", "главный тренер"))

dt_46_24_39 %>% filter(term %in% c("сезон", "игрок", "форвард", "мяч", "победа", "футбольный", "спорт", "финал", "спортсмен", "кубок", "футболист", "турнир", "тренер", "чемпион", "лига", "клуб", "команда", "сборная", "чемпионат", "матч", "чемпионат европа", "матч тур", "тур чемпионат", "матч чемпионат", "финал лига", "регулярный чемпионат", "хоккейный лига", "турнирный таблица", "национальный команда", "олимпийский игра", "групповой этап", "чемпион мир", "футбольный клуб", "официальный сайт", "плей офф", "чемпионат россия", "лига чемпион", "сборная россия", "чемпионат мир", "главный тренер"))

dt_50_47_38_51_41 %>% filter(term %in% c("сезон", "игрок", "форвард", "мяч", "победа", "футбольный", "спорт", "финал", "спортсмен", "кубок", "футболист", "турнир", "тренер", "чемпион", "лига", "клуб", "команда", "сборная", "чемпионат", "матч", "чемпионат европа", "матч тур", "тур чемпионат", "матч чемпионат", "финал лига", "регулярный чемпионат", "хоккейный лига", "турнирный таблица", "национальный команда", "олимпийский игра", "групповой этап", "чемпион мир", "футбольный клуб", "официальный сайт", "плей офф", "чемпионат россия", "лига чемпион", "сборная россия", "чемпионат мир", "главный тренер"))
```


Экономика:
  * Most Correlated Unigrams are: цена, торги, регулятор, ставка, валютный, ввп, финансовый, копейка, миллиард, экономика, минфин, инфляция, баррель, центробанк, процент, биржа, нефть, валюта, цб, банк
  * Most Correlated Bigrams are: инфляция процент, экономический рост, официальный пресс, рубль копейка, торговый сессия, финансовый рынок, иностранный валюта, доллар рубль, процент ввп, нефть доллар, министр финансы, процент пункт, кредитный организация, копейка рубль, московский биржа, миллиард доллар, доллар баррель, цена нефть, финансовый организация, банк россия
  
  
```{r}
dt_19_52_49_44 %>% filter(term %in% c("цена", "торги", "регулятор", "ставка", "валютный", "ввп", "финансовый", "копейка", "миллиард", "экономика", "минфин", "инфляция", "баррель", "центробанк", "процент", "биржа", "нефть", "валюта", "цб", "банк", "инфляция процент", "экономический рост", "официальный пресс", "рубль копейка", "торговый сессия", "финансовый рынок", "иностранный валюта", "доллар рубль", "процент ввп", "нефть доллар", "министр финансы", "процент пункт", "кредитный организация", "копейка рубль", "московский биржа", "миллиард доллар", "доллар баррель", "цена нефть", "финансовый организация", "банк россия"))

dt_30_14_15 %>% filter(term %in% c("цена", "торги", "регулятор", "ставка", "валютный", "ввп", "финансовый", "копейка", "миллиард", "экономика", "минфин", "инфляция", "баррель", "центробанк", "процент", "биржа", "нефть", "валюта", "цб", "банк", "инфляция процент", "экономический рост", "официальный пресс", "рубль копейка", "торговый сессия", "финансовый рынок", "иностранный валюта", "доллар рубль", "процент ввп", "нефть доллар", "министр финансы", "процент пункт", "кредитный организация", "копейка рубль", "московский биржа", "миллиард доллар", "доллар баррель", "цена нефть", "финансовый организация", "банк россия"))

dt_46_24_39 %>% filter(term %in% c("цена", "торги", "регулятор", "ставка", "валютный", "ввп", "финансовый", "копейка", "миллиард", "экономика", "минфин", "инфляция", "баррель", "центробанк", "процент", "биржа", "нефть", "валюта", "цб", "банк", "инфляция процент", "экономический рост", "официальный пресс", "рубль копейка", "торговый сессия", "финансовый рынок", "иностранный валюта", "доллар рубль", "процент ввп", "нефть доллар", "министр финансы", "процент пункт", "кредитный организация", "копейка рубль", "московский биржа", "миллиард доллар", "доллар баррель", "цена нефть", "финансовый организация", "банк россия"))

dt_6_3_42 %>% filter(term %in% c("цена", "торги", "регулятор", "ставка", "валютный", "ввп", "финансовый", "копейка", "миллиард", "экономика", "минфин", "инфляция", "баррель", "центробанк", "процент", "биржа", "нефть", "валюта", "цб", "банк", "инфляция процент", "экономический рост", "официальный пресс", "рубль копейка", "торговый сессия", "финансовый рынок", "иностранный валюта", "доллар рубль", "процент ввп", "нефть доллар", "министр финансы", "процент пункт", "кредитный организация", "копейка рубль", "московский биржа", "миллиард доллар", "доллар баррель", "цена нефть", "финансовый организация", "банк россия"))

dt_8_13 %>% filter(term %in% c("цена", "торги", "регулятор", "ставка", "валютный", "ввп", "финансовый", "копейка", "миллиард", "экономика", "минфин", "инфляция", "баррель", "центробанк", "процент", "биржа", "нефть", "валюта", "цб", "банк", "инфляция процент", "экономический рост", "официальный пресс", "рубль копейка", "торговый сессия", "финансовый рынок", "иностранный валюта", "доллар рубль", "процент ввп", "нефть доллар", "министр финансы", "процент пункт", "кредитный организация", "копейка рубль", "московский биржа", "миллиард доллар", "доллар баррель", "цена нефть", "финансовый организация", "банк россия"))
```


#### Correspondence plot - not interactive

```{r}
corr <- read_csv("~/Desktop/ic2s2_internet_regulation-master 2/Correspondence1.csv")
names <- corr$Community 
corr <- corr %>% select(-Community)
rownames(corr) <- names 

corr <- as.matrix(corr)


library(ggraph)
(layout <- create_layout(corr, "bipartite"))

g <- ggraph(layout) + 
  theme_graph(background = "white", base_family = "Times New Roman", base_size = 12,
  title_size = 10, title_face = "bold") +
  geom_edge_link0(aes(edge_width = weight, alpha = weight),edge_colour = "grey66", show.legend = F) +
  geom_node_point(aes(shape = type, colour = type), size = 6, show.legend = F) +
  scale_colour_manual(values = c("lightblue", "lightgreen")) +
  scale_shape_manual(values = c(15, 19)) 

g + scale_x_continuous(
  breaks = layout$x[!layout$type],
  labels = layout$name[!layout$type],
  position = "top",
  sec.axis = dup_axis(
    breaks = layout$x[layout$type],
    labels = layout$name[layout$type]
  )
) +
  theme(axis.text = element_text(), axis.text.x = element_blank()) + coord_flip() +
  ggtitle("Human-Labeled Class                          Pipeline-Labeled Class")

```


#### Correspondence plot - interactive

```{r}
tcorr <- t(corr)

library(bipartiteD3)

bipartite_D3(tcorr, PrimaryLab = "Human-Labeled",
SecondaryLab = "Pipeline-Labeled",
SiteNames = " ",
colouroption = "manual",
SortSecondary = TRUE, 
NamedColourVector= c(Community_1='#FF968A', Community_2='#CCE2CB', Community_3='#FFFFB5', Community_4='#FFCCB6', Community_5='#F3B0C3', Community_6='#C6DBDA', Community_7='#FEE1E8', Community_8='#55CDCD', Community_9='#CBAACB' , Community_10='#ECEAE4', Community_11='#EAD'))

```